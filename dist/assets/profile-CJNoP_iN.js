import{a as c,h as n}from"./app-BZQqP1S8.js";function l(){try{const e=localStorage.getItem("user");return e?JSON.parse(e):null}catch(e){return console.error("Failed to parse user data from localStorage:",e),null}}async function h(e){try{const r=await fetch(`${c}/${e}`,{method:"GET",headers:n(!0)});if(!r.ok){const a=await r.json();throw new Error(a.message||"Failed to fetch profile")}return await r.json()}catch(r){throw console.error("Error reading profile:",r.message),r}}async function f(e){try{const r=await fetch(`https://v2.api.noroff.dev/auction/profiles/${e}/listings`,{method:"GET",headers:n(!0)}),a=await r.json();if(!r.ok)throw console.error("Error fetching user listings:",a.errors||a.message),new Error(a.message||"Failed to fetch user listings");return a}catch(r){throw console.error("Error fetching user listings:",r.message),r}}async function p(e){const r=l();if(!r||!r.name)throw new Error("User not found");const a=`${c}/${r.name}`;try{const t={avatar:{url:await u(e),alt:`${r.name}'s avatar`}},s=await fetch(a,{method:"PUT",headers:n(!0),body:JSON.stringify(t)});if(!s.ok){const i=await s.json();throw new Error(i.message||"Failed to update avatar")}return console.log("Avatar updated successfully"),await s.json()}catch(o){throw console.error("Error updating avatar:",o.message),o}}async function u(e){const r="https://api.cloudinary.com/v1_1/dfe8rtu97/image/upload",a="avatar",o=new FormData;o.append("file",e),o.append("upload_preset",a);try{const t=await fetch(r,{method:"POST",body:o});if(!t.ok)throw new Error("Failed to upload image to hosting service");return(await t.json()).secure_url}catch(t){throw console.error("Error uploading image:",t.message),t}}export{f as a,h as r,p as u};
