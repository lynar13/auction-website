import{r as s,u as d}from"./listing-D27C0ejl.js";import"./app-BZQqP1S8.js";document.addEventListener("DOMContentLoaded",async()=>{const o=new URLSearchParams(window.location.search).get("id");console.log("Full URL:",window.location.href),console.log("Query String:",window.location.search),console.log("Listing ID:",o);const t=document.getElementById("editListingForm");if(!o){alert("No listing ID provided. Redirecting to listings page."),window.location.href="/listings/index.html";return}try{const n=await s(o);if(!n||!n.data)throw new Error("Listing data not found");const i=n.data;t?(t.querySelector("#title").value=i.title||"",t.querySelector("#description").value=i.description||"",t.querySelector("#tags").value=i.tags?i.tags.join(", "):"",t.querySelector("#media").value=i.media?i.media.map(r=>r.url).join(`
`):"",t.querySelector("#endDate").value=i.endsAt?new Date(i.endsAt).toISOString().split("T")[0]:"",t.addEventListener("submit",async r=>{r.preventDefault();const l=new FormData(t),e=Object.fromEntries(l.entries());e.tags=e.tags.split(",").map(a=>a.trim()),e.media=e.media.split(`
`).filter(a=>a.trim()).map(a=>({url:a.trim()})),e.endsAt=e.endDate?new Date(e.endDate).toISOString():null,delete e.endDate;try{await d(o,e),alert("Listing updated successfully!"),window.location.href="/listings/index.html"}catch(a){console.error("Failed to update listing:",a.message),alert("Failed to update listing. Please try again.")}})):console.error("Form element not found")}catch(n){console.error("Failed to load listing data:",n.message),alert("Failed to load listing.")}});
