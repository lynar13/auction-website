import{r as l,u as d}from"./listing-C2KN82Sj.js";import"./cachedFetch-OvMXQHTG.js";import"./app-vh6XL3P4.js";document.addEventListener("DOMContentLoaded",async()=>{const r=new URLSearchParams(window.location.search).get("id"),e=document.getElementById("editListingForm");if(!r){alert("No listing ID provided. Redirecting to listings page."),window.location.href="/listings/index.html";return}try{const n=await l(r);if(!n||!n.data)throw new Error("Listing data not found");const a=n.data;e?(e.querySelector("#title").value=a.title||"",e.querySelector("#description").value=a.description||"",e.querySelector("#tags").value=a.tags?a.tags.join(", "):"",e.querySelector("#media").value=a.media?a.media.map(o=>o.url).join(`
`):"",e.querySelector("#endDate").value=a.endsAt?new Date(a.endsAt).toISOString().split("T")[0]:"",e.addEventListener("submit",async o=>{o.preventDefault();const s=new FormData(e),t=Object.fromEntries(s.entries());t.tags=t.tags.split(",").map(i=>i.trim()),t.media=t.media.split(`
`).filter(i=>i.trim()).map(i=>({url:i.trim()})),t.endsAt=t.endDate?new Date(t.endDate).toISOString():null,delete t.endDate;try{await d(r,t),alert("Listing updated successfully!"),window.location.href="/listings/index.html"}catch(i){console.error("Failed to update listing:",i.message),alert("Failed to update listing. Please try again.")}})):console.error("Form element not found")}catch(n){console.error("Failed to load listing data:",n.message),alert("Failed to load listing.")}});
