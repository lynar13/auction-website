import{r as l,u as d}from"./listing-DDq9Lyx5.js";import"./app-BSg41Yl5.js";document.addEventListener("DOMContentLoaded",async()=>{const r=new URLSearchParams(window.location.search).get("id");console.log("Listing ID:",r);const t=document.getElementById("editListingForm");if(!r){alert("No listing ID specified.");return}try{const n=await l(r);if(!n||!n.data)throw new Error("Listing data not found");const a=n.data;t?(t.querySelector("#title").value=a.title||"",t.querySelector("#description").value=a.description||"",t.querySelector("#tags").value=a.tags?a.tags.join(", "):"",t.querySelector("#media").value=a.media?a.media.map(o=>o.url).join(`
`):"",t.querySelector("#endDate").value=a.endsAt?new Date(a.endsAt).toISOString().split("T")[0]:"",t.addEventListener("submit",async o=>{o.preventDefault();const s=new FormData(t),e=Object.fromEntries(s.entries());e.tags=e.tags.split(",").map(i=>i.trim()),e.media=e.media.split(`
`).filter(i=>i.trim()).map(i=>({url:i.trim()})),e.endsAt=e.endDate?new Date(e.endDate).toISOString():null,delete e.endDate;try{await d(r,e),alert("Listing updated successfully!"),window.location.href=`/profile/index.html?id=${r}`}catch(i){console.error("Failed to update listing:",i.message),alert("Failed to update listing.")}})):console.error("Form element not found")}catch(n){console.error("Failed to load listing data:",n.message),alert("Failed to load listing.")}});
