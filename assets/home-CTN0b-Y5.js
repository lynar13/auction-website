import{c as E,a as f}from"./listing-xXRwS0O9.js";import"./app-BPAMsPET.js";document.addEventListener("DOMContentLoaded",()=>{let o=1;const i=12,m=document.getElementById("listingList"),u=document.getElementById("pagination"),c=document.getElementById("searchInput"),r=document.getElementById("sortOptions"),g=document.getElementById("createListingForm"),v=document.getElementById("loginButton"),y=document.getElementById("registerButton"),p=document.getElementById("logoutButton");localStorage.getItem("user")?(v.style.display="none",y.style.display="none",p.style.display="block"):p.style.display="none";async function l(n=1,t=12,e="",a=""){try{const s=await f(n,t,e,a),d=s.total||s.length;L(s.results||s),h(d)}catch(s){console.error("Failed to load listings:",s)}}function L(n){m.innerHTML="",n.forEach(t=>{const e=document.createElement("div");e.className="col-lg-4 col-md-6 col-sm-12 mb-4";const a=t.media?.[0]?.url?`<img src="${t.media[0].url}" alt="${t.title}" class="img-fluid rounded mb-3">`:'<img src="https://via.placeholder.com/400" alt="Default Image" class="img-fluid rounded mb-3">',s=t.endsAt?`<p class="text-muted small"><strong>Ends At:</strong> ${new Date(t.endsAt).toLocaleString()}</p>`:'<p class="text-muted small"><strong>Ends At:</strong> No expiration date</p>',d=t.id?`<a href="/auction-website/listing/index.html?id=${encodeURIComponent(t.id)}" class="btn btn-primary mt-auto">Place a Bid</a>`:'<p class="text-muted small">No valid listing ID available.</p>';e.innerHTML=`
        <div class="card h-100 border-0 shadow-sm">
          <div class="media-gallery">${a}</div>
          <div class="card-body d-flex flex-column">
            <h5 class="card-title text-truncate">${t.title||"Untitled"}</h5>
            <p class="card-text text-truncate">${t.description?.slice(0,100)||"No description available"}...</p>
            ${s}
            ${d}
          </div>
        </div>
      `,m.appendChild(e)})}function h(n){const t=Math.ceil(n/i);u.innerHTML="";for(let e=1;e<=t;e++){const a=document.createElement("li");a.className=`page-item ${o===e?"active":""}`,a.innerHTML=`<a class="page-link" href="#">${e}</a>`,a.addEventListener("click",s=>{s.preventDefault(),o=e,l(o,i,c.value.trim(),r.value)}),u.appendChild(a)}}c.addEventListener("input",()=>{const n=c.value.trim();l(1,i,n,r.value)}),r.addEventListener("change",()=>{const n=r.value;l(1,i,c.value.trim(),n)}),g&&g.addEventListener("submit",async n=>{n.preventDefault();const t={title:listingTitle.value.trim(),description:listingContent.value.trim()};try{await E(t),listingTitle.value="",listingContent.value="",l(1,i)}catch(e){console.error("Failed to create a new listing:",e)}}),l(o,i)});
